#!/bin/sh

if [ "$(whoami)" != "root" ]; then
	echo "Root privileges needed"; exit
elif [ $# = 0 ]; then
	echo "No device given"; exit
fi

for device in "$@"; do
	if [ ! -e "$device" ]; then
		echo "'$device' not found"; exit
	fi

	if mount | grep -q "$device"; then
		echo "Syncing..."; sync
		umount "$device"
		echo "$device unmounted"
		mntdir="/mnt/$(basename $device)"
		rmdir "$mntdir"
	else
		mntdir="/mnt/$(basename $device)"
		mkdir -p "$mntdir"
		mount "$device" "$mntdir"
		echo "$device mounted"
	fi
done
