#!/bin/sh

# DWM panel script
# Relies on Font Awesome 6 Pro <https://fontawesome.com/search>

{
	## Uptime
	#echo "ðŸ’»"
	#uptime --pretty | cut -d' ' -f2-

	# Date
	date "+ %b %d %R"
	echo ";"

	# Keyboard language
	command -v xkblayout-state >/dev/null 2>&1 && {
		echo ï„œ
		xkblayout-state print '%s' | tr '[:lower:]' '[:upper:]'
		echo ""
	}

	# Volume
	pamixer --get-volume --get-mute |
		awk '{
			if ($1 == "true")
				print "ï‹¢"
			else
				print "ðŸ”Š"
				#print "ï€¥"
			print $2 "%"
		}'

	# Network
	awk '
	#BEGIN {print "ðŸ“¶"}
	{
		if ($0 ~ /^up$/) {
			n=1
			exit
		}
	}
	END {
		if (n) {
			print "ï‡«"
			system("nmcli -t -f connection dev status | sed \"/^\s*$/d;/lo/d\"")
		} else {
			print "ïš¬"
		}
	}' /sys/class/net/*/operstate

	# Battery
	awk 'BEGIN {print "ðŸ”‹"} /Charging/ {printf "+"} /[0-9]/ {print $0 "%"}' \
		/sys/class/power_supply/BAT*/status /sys/class/power_supply/BAT*/capacity
} | tr '\n' ' '
